# Аналіз продуктивності Sewing-Manager

## Методологія профілювання

### Інструменти профілювання
Для аналізу продуктивності безпосередьно цієї роботи використано інструмент Visual Studio Diagnostic Tools
Він пропонує вбудоване профілювання CPU та пам’яті під час виконання додатка.

Для більш детального профілювання інсують і інші програмні засоби.
 - Для CPU-профілювання можна використовувати DotTrace або PerfView, які дозволяють фіксувати та аналізувати затримки та використання процесора.
 - Для моніторингу пам'яті: dotMemory від JetBrains
 - Для профілювання запитів до БД - SQL Server Profiler або EF Core Logging. Наразі БД не застосовується, тому в профілювання такого виду потреби немає.

Хоча вище перелічені засоби і мають більші можливості, для початку вистачить і вбудованих засобів Visual Studio.

### Ключові метрики продуктивності
Для додатка **Sewing-Manager** визначено такі метрики:
- **Час обробки SignalR-запитів**: Час на передачу даних між клієнтом і сервером через SignalR.
- **Використання CPU**: Час виконання ключових методів (рендеринг компонентів, обробка даних).
- **Використання пам’яті**: Обсяг пам’яті, виділений для компонентів і даних.
- **Час рендерингу UI**: Час на оновлення компонентів Blazor.

### Тестовий сценарій
**Завантаження фотографій**:
   - Додавання до позиції фотографій різного розміру.
   - Метрика: час завантаження, обробки та встановлення фотографії на прев'ю.

**Тестовий набір даних**:
- Фотографії різного об'єму: від 512 Кб до 15 Мб.

## Налаштування інструментів

1. **Visual Studio Diagnostic Tools**:
   - Увімкнено профілювання CPU та пам’яті (Debug > Windows > Show Diagnostic Tools).
   - Налаштовано точки зупинки для збору даних під час виконання тестових сценаріїв.

## Результати профілювання

### Тест 1: Додавання невеликої фотографії - 512 Кб
**Методологія:**
 - Було проведено два знімки пам’яті: до і після завантаження фотографії невеликої роздільної здатності (512 Кб).

**Результати:**
 - Обсяг пам'яті збільшився невідчутно (5-6 Мб)
 - Прев'ю фотографії відбразилось одразу, блокування інших задач не відмічено.

### Тест 2: Додавання фотографії середнього розміру - 3-4 Мб
**Методологія:**
 - Було проведено два знімки пам’яті: до і після завантаження фотографії середньої роздільної здатності (3,46 Мб).

**Результати:**
 - Обсяг пам'яті збільшився (~50 Мб)
 - Прев'ю фотографії відбразилось одразу, блокування інших задач не відмічено.

### Тест 3: Додавання фотографії великого розміру - 13+ Мб
**Методологія:**
 - Було проведено два знімки пам’яті: до і після завантаження фотографії великої роздільної здатності (15,6 Мб).

**Результати:**
- Обсяг пам’яті збільшився на ~350MB і не зменшився після завершення обробки.
- Прев'ю доданої фотографії з'явилось через ~2 сек. і цей процес блокував інші SignalR-підключення.
- Затримка в UI була відчутна — події клієнта не передавались до завершення обробки.
- Пік навантаження на CPU був під час обробки фотографії.

**Висновки:**
- Поточна реалізація збереження фото є синхронною та ресурсоємною.
- Потрібно:
  - Впровадити ресайз на клієнті.
  - Обмежити розмір файлів.
  - Переписати обробку у потоковому (streamed) стилі.
  - Забезпечити асинхронну обробку без блокування SignalR-потоку.

## Висновки
Результати тестування показали, що система стабільно обробляє невеликі та середні зображення, не впливаючи на загальну продуктивність. Проте великі файли викликають значне навантаження на пам’ять і CPU, блокують SignalR-підключення та потребують оптимізації через асинхронну та потокову обробку.
